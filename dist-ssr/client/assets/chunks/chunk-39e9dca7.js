import{j as $,r as c,z as F,i as N,P as B,G as R,o as d,c as S,w as r,f as x,a as k,d as g,h as T,b as a,t as E,n as U,u as b,s as q,B as I}from"./chunk-b8a590ba.js";import{V as L,b as z,_ as P}from"./chunk-03e38bfb.js";import{b as V,t as j,A}from"./chunk-544fb087.js";import{_ as D}from"./chunk-c27b6911.js";/* empty css              *//* empty css              *//* empty css              */import{V as G}from"./chunk-b5430311.js";import"./chunk-96a2c380.js";import"./chunk-372590c2.js";import"./chunk-101896b7.js";const O=new Set(["v_play","v_playing","v_pause","v_ended","v_error","v_seeking","v_seeked","v_timeupdate","v_waiting","v_canplay","v_canplaythrough","v_durationchange","v_volumechange","v_bufferedChange","v_definitionChange","v_playbackrateChange","v_screenShot","v_requestFullscreen","v_exitFullscreen","v_requestCssFullscreen","v_exitCssFullscreen","v_getRotateFullscreen","v_exitRotateFullscreen","v_controlShow","v_controlHide","v_resize"]);class H{constructor(t){this.ele=t,this.init(t)}init(t){t&&(console.info("======================= init event ========================="),window.addEventListener("message",o=>{let{event:n,data:i}=o.data;if(O.has(n))switch(n=n.replace(/^v_/,""),n){case"requestCssFullscreen":t.className+="h-full w-full";break;case"exitCssFullscreen":t.className=t.className.replace(/(h-full|w-full)/,"");break;case"resize":t.style.height=i.height+"px";break}}))}}const Y=["src"],M=$({__name:"index",props:{res:{type:Object,required:!0,default:{}}},setup(h){const t=h;V();const o=c(!0),n=c(""),i=c();c(!1);const l=!0;let p;function u(e){n.value=e}function y(){o.value=!1,new H(i.value)}function v(e){return`${globalThis.VIDEO_URL||"https://svbcdn.github.io/xplayer"}?id=${encodeURIComponent(e)}`}return F(()=>{t.res.url&&u(v(t.res.url))}),N(t.res,e=>{e.url&&u(v(e.url))}),B(()=>{}),R(()=>{}),globalThis.addEventListener("beforeunload",()=>{console.info("set lastPlayTime",p.currentTime),localStorage.setItem(t.res.url,p.currentTime+"")}),(e,s)=>{const _=g.NSpin;return d(),S(_,{show:o.value,size:"large"},{default:r(()=>[x("div",null,[l?(d(),k("iframe",{key:0,id:"ifa-video",src:n.value,width:"100%",scrolling:"no",style:{overflow:"hidden"},allowfullscreen:"",class:"player",ref_key:"videoRef",ref:i,onLoad:y},null,40,Y)):(d(),k("div",{key:1,ref_key:"videoRef",ref:i,class:"player"},null,512))])]),_:1},8,["show"])}}});const J=D(M,[["__scopeId","data-v-2fff8e54"]]),K={class:"text-28px",style:{display:"inline-block","margin-right":"30px"}},re=$({__name:"[id]",setup(h){const t=V(),o=j(),{proxy:n}=I(),i=T(()=>{let e=n.$route.params.id;return e instanceof Array?e[0]:e}),l=c(t.inSSR?n.$root.$attrs.detail:{id:"",lines:[]}),p=c([]),u=c(!1);async function y(e){let s=await o.toggleFav({id:e.vid,title:e.title,logo:e.logo,desc:e.desc,quality:e.quality});u.value=s}F(async()=>{let e=await v(i.value);e&&(u.value=await o.hasFav(e.vid),o.addPlayed(i.value))});async function v(e){var _,f,m;(_=globalThis.$loadingBar)==null||_.start();let{data:s}=await A(e);if((f=globalThis.$loadingBar)==null||f.finish(),!s){(m=globalThis.$message)==null||m.warning("video is no data");return}return Object.assign(l.value,s),n.$route.meta.title=s.title,t.setTitle(s.title),p.value=[s.url],s}return(e,s)=>{const _=J,f=P,m=g.NButton,w=g.NGi,C=g.NGrid;return d(),k("div",null,[a(C,{class:"player",cols:"20",responsive:"screen","item-responsive":!0,"x-gap":"6 m:6","y-gap":"6 m:12"},{default:r(()=>[a(w,{span:"20 m:13"},{default:r(()=>[a(_,{res:l.value},null,8,["res"]),x("div",null,[x("p",K,E(l.value.title),1),a(m,{onClick:s[0]||(s[0]=Q=>y(l.value))},{icon:r(()=>[a(f,{style:U({color:u.value?"#ff0000":"#ffffff"})},null,8,["style"])]),_:1})])]),_:1}),a(w,{span:"20 m:7"},{default:r(()=>[a(C,{cols:"10",responsive:"screen","item-responsive":!0},{default:r(()=>[a(w,{span:"10"},{default:r(()=>[l.value.vid?(d(),S(b(L),{key:0,detail:l.value,top:10},null,8,["detail"])):q("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),a(b(z),{id:l.value.vid},null,8,["id"]),a(b(G))])}}});export{re as default};
