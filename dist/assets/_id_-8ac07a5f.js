import{g as $,u as F,z as c,A as N,w as V,aN as T,B,o as d,h as S,i as r,f as b,e as k,k as g,aP as R,c as q,aT as E,l as a,t as U,x as I,j as x,q as L,P}from"./index-cc9450de.js";import{V as z,b as j,_ as A}from"./line-d5335143.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css              *//* empty css                                                                */import"./index.vue_vue_type_style_index_0_scoped_a68c73cf_lang-b5acc043.js";import{V as O}from"./index-ca6e8caf.js";import"./g-image-cd4f0901.js";const G=new Set(["v_play","v_playing","v_pause","v_ended","v_error","v_seeking","v_seeked","v_timeupdate","v_waiting","v_canplay","v_canplaythrough","v_durationchange","v_volumechange","v_bufferedChange","v_definitionChange","v_playbackrateChange","v_screenShot","v_requestFullscreen","v_exitFullscreen","v_requestCssFullscreen","v_exitCssFullscreen","v_getRotateFullscreen","v_exitRotateFullscreen","v_controlShow","v_controlHide","v_resize"]);class H{constructor(t){this.ele=t,this.init(t)}init(t){t&&(console.info("======================= init event ========================="),window.addEventListener("message",o=>{let{event:n,data:i}=o.data;if(G.has(n))switch(n=n.replace(/^v_/,""),n){case"requestCssFullscreen":t.className+="h-full w-full";break;case"exitCssFullscreen":t.className=t.className.replace(/(h-full|w-full)/,"");break;case"resize":t.style.height=i.height+"px";break}}))}}const Y=["src"],M=$({__name:"index",props:{res:{type:Object,required:!0,default:{}}},setup(h){const t=h;F();const o=c(!0),n=c(""),i=c();c(!1);const l=!0;let v;function u(e){n.value=e}function y(){o.value=!1,new H(i.value)}function p(e){return`${globalThis.VIDEO_URL||"https://svbcdn.github.io/xplayer"}?id=${encodeURIComponent(e)}`}return N(()=>{t.res.url&&u(p(t.res.url))}),V(t.res,e=>{e.url&&u(p(e.url))}),T(()=>{}),B(()=>{}),globalThis.addEventListener("beforeunload",()=>{console.info("set lastPlayTime",v.currentTime),localStorage.setItem(t.res.url,v.currentTime+"")}),(e,s)=>{const _=g.NSpin;return d(),S(_,{show:o.value,size:"large"},{default:r(()=>[b("div",null,[l?(d(),k("iframe",{key:0,id:"ifa-video",src:n.value,width:"100%",scrolling:"no",style:{overflow:"hidden"},allowfullscreen:"",class:"player",ref_key:"videoRef",ref:i,onLoad:y},null,40,Y)):(d(),k("div",{key:1,ref_key:"videoRef",ref:i,class:"player"},null,512))])]),_:1},8,["show"])}}});const J=D(M,[["__scopeId","data-v-2fff8e54"]]),K={class:"text-28px",style:{display:"inline-block","margin-right":"30px"}},le=$({__name:"[id]",setup(h){const t=F(),o=R(),{proxy:n}=P(),i=q(()=>{let e=n.$route.params.id;return e instanceof Array?e[0]:e}),l=c(t.inSSR?n.$root.$attrs.detail:{id:"",lines:[]}),v=c([]),u=c(!1);async function y(e){let s=await o.toggleFav({id:e.vid,title:e.title,logo:e.logo,desc:e.desc,quality:e.quality});u.value=s}N(async()=>{let e=await p(i.value);e&&(u.value=await o.hasFav(e.vid),o.addPlayed(i.value))});async function p(e){var _,f,m;(_=globalThis.$loadingBar)==null||_.start();let{data:s}=await E(e);if((f=globalThis.$loadingBar)==null||f.finish(),!s){(m=globalThis.$message)==null||m.warning("video is no data");return}return Object.assign(l.value,s),n.$route.meta.title=s.title,t.setTitle(s.title),v.value=[s.url],s}return(e,s)=>{const _=J,f=A,m=g.NButton,w=g.NGi,C=g.NGrid;return d(),k("div",null,[a(C,{class:"player",cols:"20",responsive:"screen","item-responsive":!0,"x-gap":"6 m:6","y-gap":"6 m:12"},{default:r(()=>[a(w,{span:"20 m:13"},{default:r(()=>[a(_,{res:l.value},null,8,["res"]),b("div",null,[b("p",K,U(l.value.title),1),a(m,{onClick:s[0]||(s[0]=Q=>y(l.value))},{icon:r(()=>[a(f,{style:I({color:u.value?"#ff0000":"#ffffff"})},null,8,["style"])]),_:1})])]),_:1}),a(w,{span:"20 m:7"},{default:r(()=>[a(C,{cols:"10",responsive:"screen","item-responsive":!0},{default:r(()=>[a(w,{span:"10"},{default:r(()=>[l.value.vid?(d(),S(x(z),{key:0,detail:l.value,top:10},null,8,["detail"])):L("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),a(x(j),{id:l.value.vid},null,8,["id"]),a(x(O))])}}});export{le as default};
